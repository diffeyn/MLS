setwd("G:/My Drive/GitHubProjects/MLS")
library(tidyverse)
library(lubridate)
player_data = read.csv('../data/scraping/teams/teams_Apr 1, 2015.csv')
player_data = read.csv('/data/scraping/teams/teams_Apr 1, 2015.csv')
library(readr)
player_data <- read_csv("data/scraping/teams/teams_Apr 1, 2015.csv")
View(player_data)
head(player_data)
player_data = read.csv('../data/scraping/teams/teams_Apr 1, 2015.csv')
player_data2 = player_data %>%
colnames('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation,, ' ', simplify = TRUE) %>%
str_remove(worth_euro, '€') %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
colnames('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation,, ' ', simplify = TRUE) %>%
str_remove(worth_euro, '	€') %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
colnames('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation,, ' ', simplify = TRUE) %>%
str_remove(worth_euro, '€') %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
colnames('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation,, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
library(tidyverse)
library(lubridate)
player_data = read.csv('../data/scraping/teams/teams_Apr 1, 2015.csv')
library(tidyverse)
library(lubridate)
player_data = read.csv('../data/scraping/teams/teams_Apr 1, 2015.csv')
library(tidyverse)
library(lubridate)
player_data = read.csv('../data/scraping/teams/teams_Apr 1, 2015.csv')
head(player_data)
player_data2 = player_data %>%
colnames('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation,, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
colnames('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
rename('team_name', 'team_id', 'team_formation', 'overall_score', 'attack', 'midfield', 'defense', 'worth_euro', 'num_players', 'trash',) %>%
str_split(Formation, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
rename(Name = team_name, ID = team_id, Formation = team_formation, Overall = overall_score, Attack = attack, Midfield = midfield, Defence = defense, Club worth = worth_euro, Players = num_players, ...11 = trash,) %>%
player_data2 = player_data %>%
rename(Name = team_name, ID = team_id, Formation = team_formation, Overall = overall_score, Attack = attack, Midfield = midfield, Defence = defense, `Club worth` = worth_euro, Players = num_players, ...11 = trash,) %>%
str_split(Formation, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(Formation, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(team_formation, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11)
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(team_formation, ' ', simplify = TRUE) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(team_formation, ' ', simplify = TRUE)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(team_formation, ' ', simplify = TRUE)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(player_data[team_formation], ' ', simplify = TRUE)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(, ' ', simplify = FALSE)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
str_split(team_formation, ' ', simplify = FALSE)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style'), sep = ' ') %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)```
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style'), sep = ' ') %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)```
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)```
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(str_remove(team_name, 'Major League Soccer')) %>%
mutate(str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(str_remove(team_name, 'Major League Soccer')) %>%
mutate(str_remove(worth_euro, '€'))
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€'))
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
head(player_data2)
player_data2 = player_data %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
head(player_data2)
player_data2 = player_data %>%
rename(trash00 = ...1, team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric)
head(player_data2)
player_data2 = player_data %>%
rename(trash00 = ...1, team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
```{r}
head(player_data2)
links = list.files('../data/scraping/teams/', full.names = TRUE)
for (link in links){
df = read.csv(link)
df_clean = clean_teams(df)
date = str_remove(str_extract(link, ' [A-Za-z]+ [0-9]{1,2}, [0-9]{4}'), ' ')
write.csv(df_clean, paste0('../data/cleaned/teams/teams_', date, '.csv'))
}
write.csv(df_clean, paste0('../data/data_clean/teams/teams_', date, '.csv'))
links = list.files('../data/scraping/teams/', full.names = TRUE)
for (link in links){
df = read.csv(link)
df_clean = clean_teams(df)
date = str_remove(str_extract(link, ' [A-Za-z]+ [0-9]{1,2}, [0-9]{4}'), ' ')
write.csv(df_clean, paste0('../data/data_clean/teams/teams_', date, '.csv'))
}
links = list.files('../data/scraping/teams/', full.names = TRUE)
for (link in links){
df = read.csv(link)
df_clean = clean_teams(df)
date = str_remove(str_extract(link, ' [A-Za-z]+ [0-9]{1,2}, [0-9]{4}'), ' ')
write.csv(df_clean, paste0('teams_', date, '.csv'))
}
print(links)
links = list.files('../data/scraping/teams/*.csv', full.names = TRUE)
print(links)
csv_files <- list.files(path = '../data/scraping/teams/', patte
print(links)
print(csv_files)
csv_files <- list.files(path = '../data/scraping/teams/', pattern = "\\.csv$", full.names = TRUE)
print(csv_files)
csv_files <- list.files(path = '../data/scraping/teams/', pattern = "\\.csv", full.names = TRUE)
print(csv_files)
csv_files <- list.files(path = '../data/scraping/teams/', full.names = TRUE)
print(csv_files)
csv_files <- list.files(path = '../data/scraping/teams', full.names = TRUE)
print(csv_files)
csv_files <- list.files(path = '/data/scraping/teams', full.names = TRUE)
print(csv_files)
csv_files <- list.files(path = '/data/scraping/teams/', full.names = TRUE)
print(csv_files)
csv_files = lapply(csv_files, read.csv)
print(csv_files)
csv_files = list.files(path = '/data/scraping/teams/', full.names = TRUE)
csv_files = lapply(csv_files, read.csv)
print(csv_files)
csv_files = list.files(path = '../data/scraping/teams/', full.names = TRUE)
csv_files = lapply(csv_files, read.csv)
print(csv_files)
csv_files = lapply(csv_files, '\\.csv$', read.csv)
print(csv_files)
csv_files = list.files(path = '../data/scraping/teams/', '\\.csv$', full.names = TRUE)
csv_files = lapply(csv_files, read.csv)
print(csv_files)
dir()
getwd()
setwd('../data/scraping/teams/')
csv_files = list.files(path = '../scraping/teams/', '\\.csv$', full.names = TRUE)
csv_files = lapply(csv_files, read.csv)
print(csv_files)
list.files("G:/My Drive/GitHubProjects/MLS/data/scraping/teams")
csv_files = list.files(path = 'G:/My Drive/GitHubProjects/MLS/data/scraping/teams', '\\.csv$', full.names = TRUE)
csv_files = lapply(csv_files, read.csv)
csv_files = list.files(path = 'G:/My Drive/GitHubProjects/MLS/data/scraping/teams', '\\.csv$', full.names = TRUE)
csv_files = lapply(csv_files, read.csv)
csv_files = list.files(path = 'G:/My Drive/GitHubProjects/MLS/data/scraping/teams', '\\.csv$', full.names = TRUE)
print(csv_files)
for (file in csv_files){
cleaned = clean_teams(file)
date_str <- str_remove(file, "teams_|\\.xlsx$")
date = mdy(date_str)
write.csv(cleaned, paste0('G:/My Drive/GitHubProjects/MLS/data/data_clean/teams/teams_', date, '.csv'))
}
clean_teams = function(df){
df2 = df %>%
rename(trash00 = ...1, team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
return(df2)
}
for (file in csv_files){
cleaned = clean_teams(file)
date_str <- str_remove(file, "teams_|\\.xlsx$")
date = mdy(date_str)
write.csv(cleaned, paste0('G:/My Drive/GitHubProjects/MLS/data/data_clean/teams/teams_', date, '.csv'))
}
for (file in csv_files){
cleaned = clean_teams(file)
date_str <- str_remove(file, "teams_|\\.xlsx$")
date = mdy(date_str)
write.csv(cleaned, paste0('G:/My Drive/GitHubProjects/MLS/data/data_clean/teams/teams_', date, '.csv'))
}
for (file in csv_files){
df = read.csv(file)
cleaned = clean_teams(df)
date_str <- str_remove(file, "teams_|\\.xlsx$")
date = mdy(date_str)
write.csv(cleaned, paste0('G:/My Drive/GitHubProjects/MLS/data/data_clean/teams/teams_', date, '.csv'))
}
player_data = read.csv('../data/scraping/teams/teams_Mar 1, 2022.csv')
player_data = read.csv('../scraping/teams/teams_Mar 1, 2022.csv')
player_data = read.csv('/scraping/teams/teams_Mar 1, 2022.csv')
player_data = read.csv('G:/My Drive/GitHubProjects/MLS/data/scraping/teams/teams_Aug 20, 2024.csv')
head(player_data)
player_data2 = player_data %>%
rename(trash00 = ...1, team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
player_data2 = player_data %>%
select(-1) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
player_data2 = player_data %>%
select(-1) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = `Club worth`, num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
player_data2 = player_data %>%
select(-1) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players, trash = ...11) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
head(player_data2)
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€', 'M')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-starts_with('trash'))
mutate(worth_euro = str_remove(worth_euro, c('€', 'M')) %>%
select(-starts_with('trash'))
head(player_data2)
select(-starts_with('trash'))
mutate_at(vars(overall_score:num_players), as.numeric)
column_to_rownames('team_id')```
column_to_rownames('team_id')
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, c('€', 'M')) %>%
column_to_rownames('team_id')
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-trash2)
mutate(worth_euro = str_remove(worth_euro, c('€', 'M')) %>%
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, c('€', 'M')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-trash2)
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, c('€', 'M'))) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-trash2)
player_data2 = player_data %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
mutate(worth_euro = str_remove_all(worth_euro, 'M')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-trash2)
head(player_data2)
clean_teams = function(df){
df2 = df %>%
select(-1, -ncol(.)) %>%
rename(team_name = Name, team_id = ID, team_formation = Formation, overall_score = Overall, attack = Attack, midfield = Midfield, defense = Defence, worth_euro = any_of(c('Club worth', 'Club.worth')), num_players = Players) %>%
separate(team_formation, into = c('lineup', 'style', 'trash2'), sep = ' ') %>%
mutate(team_name = str_remove(team_name, 'Major League Soccer')) %>%
mutate(worth_euro = str_remove(worth_euro, '€')) %>%
mutate(worth_euro = str_remove_all(worth_euro, 'M')) %>%
column_to_rownames('team_id') %>%
mutate_at(vars(overall_score:num_players), as.numeric) %>%
select(-trash2)
return(df2)
}
csv_files = list.files(path = 'G:/My Drive/GitHubProjects/MLS/data/scraping/teams', '\\.csv$', full.names = TRUE)
print(csv_files)
for (file in csv_files){
df = read.csv(file)
cleaned = clean_teams(df)
date_str <- str_remove(file, "teams_|\\.xlsx$")
date = mdy(date_str)
write.csv(cleaned, paste0('G:/My Drive/GitHubProjects/MLS/data/data_clean/teams/teams_', date, '.csv'))
}
